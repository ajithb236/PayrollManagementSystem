# PayrollManagement System

A comprehensive web-based payroll management solution built with Django, designed to streamline employee compensation, attendance tracking, leave management, and financial reporting for organizations.

## ğŸ“‹ Features

### Multi-User Role System
- **Employee Portal**: Self-service dashboard for personal payroll information
- **HR Portal**: Comprehensive management of all payroll and employee data
- **Authentication**: Secure login using Django's authentication system with custom user model
- **Implementation**: Role-based access control with dedicated views for each user type

### Employee Management
- Complete employee profile management with personal and professional details
- Department and job role assignment system
- Manager designation within organizational structure
- **Implementation**: SQL triggers initialize employee records with default values upon creation

### Payroll Processing
- **Automated Salary Calculation**:
  - Base salary management based on job roles
  - Configurable allowances (HRA: 40% of base, DA: 10% of base, TA: fixed â‚¹3200)
  - Overtime compensation (hourly rate = base salary/160 Ã— 2)
  - Bonus processing with manual adjustments
  - **Implementation**: Database triggers update allowances and taxes automatically

- **Deduction Management**:
  - Progressive tax calculations using `calculate_tax()` MySQL function
  - EPF (Employee Provident Fund) at 12% of base salary
  - Professional tax (fixed at â‚¹200)
  - Other customizable deductions

### Attendance & Leave Management
- **Attendance Tracking**:
  - Daily work hours recording
  - Overtime logging and approval workflow
  - **Implementation**: Overtime hours automatically affect salary calculations

- **Leave Management**:
  - Multiple leave types (Vacation, Sick, Others)
  - Leave request submission and approval workflow
  - Leave balance tracking
  - **Implementation**: `after_leave_approval` trigger updates attendance records

### Financial Processing
- Salary disbursement with multiple payment modes
- Transaction tracking with unique reference numbers
- Bank account integration for payroll processing
- **Implementation**: `generate_bank_account()` function creates unique transaction IDs

### Comprehensive Reporting
- **Payroll Reports**: Detailed salary breakdowns by department
- **Attendance Reports**: Work hours and overtime analytics
- **Leave Reports**: Leave utilization and balance statistics
- **Tax Reports**: Tax deduction summaries by employee and department
- Export options in multiple formats (PDF, Excel, CSV)

### HR Analytics Dashboard
- Department headcount visualization
- Salary distribution metrics with min/max/average analysis
- Financial breakdown with interactive charts
- Recent joiners tracking

## ğŸ› ï¸ Technology Stack

- **Backend**:
  - Django 5.1 (Python web framework)
  - Custom middleware for role-based security

- **Database**:
  - MySQL 8.0 with custom PL/SQL functions and triggers
  - Complex data relationships with foreign key constraints

- **Frontend**:
  - HTML/CSS with chart.js for data visualisation.

- **Additional Libraries**:
  - django-widget-tweaks: Enhanced form rendering
  - django-extensions: Development tools
  - pymysql: MySQL database connector
  - reportlab: PDF generation

## ğŸ“ File Structure

```
PayrollManagement/
â”œâ”€â”€ PayrollManagement/           # Project settings
â”‚   â”œâ”€â”€ settings.py              # Django settings
â”‚   â”œâ”€â”€ urls.py                  # Main URL routing
â”‚   â””â”€â”€ wsgi.py                  # WSGI configuration
â”œâ”€â”€ accounts/                    # User authentication
â”‚   â”œâ”€â”€ models.py                # CustomUser model
â”‚   â”œâ”€â”€ views.py                 # Login/logout views
â”‚   â””â”€â”€ templates/               # Authentication templates
â”œâ”€â”€ employee/                    # Employee module
â”‚   â”œâ”€â”€ views.py                 # Employee views
â”‚   â”œâ”€â”€ urls.py                  # Employee URL patterns
â”‚   â””â”€â”€ templates/               # Employee templates
â”‚       â”œâ”€â”€ dashboard.html       # Employee dashboard
â”‚       â”œâ”€â”€ profile.html         # Profile management
â”‚       â”œâ”€â”€ salary.html          # Salary details view
â”‚       â”œâ”€â”€ transaction_history.html  # Payment history
â”‚       â”œâ”€â”€ request_leave.html   # Leave request form
â”‚       â”œâ”€â”€ leave_balance.html   # Leave balance tracking
â”‚       â”œâ”€â”€ attendance_details.html  # Attendance records
â”‚       â””â”€â”€ clock_overtime.html  # Overtime logging
â”œâ”€â”€ hr/                          # HR module
â”‚   â”œâ”€â”€ views.py                 # HR functionality
â”‚   â”œâ”€â”€ urls.py                  # HR URL patterns
â”‚   â””â”€â”€ templates/               # HR templates
â”‚       â”œâ”€â”€ dashboard.html       # HR dashboard
â”‚       â”œâ”€â”€ assign_employee.html # Role assignment
â”‚       â”œâ”€â”€ update_payscales.html # Salary management
â”‚       â”œâ”€â”€ manage_employee.html # Employee management
â”‚       â”œâ”€â”€ approve_leaves.html  # Leave approval
â”‚       â”œâ”€â”€ salary_disbursement.html # Process payments
â”‚       â”œâ”€â”€ payment_history.html # Payment records
â”‚       â”œâ”€â”€ generate_reports.html # Report generation
â”‚       â”œâ”€â”€ metrics_dashboard.html # HR analytics
â”‚       â”œâ”€â”€ attendance_details.html # Track attendance
â”‚       â””â”€â”€ profile.html         # HR profile
â”œâ”€â”€ payroll/                     # Core payroll models
â”‚   â”œâ”€â”€ models.py                # Database models
â”‚   â””â”€â”€ migrations/              # Database migrations
â”œâ”€â”€ templates/                   # Global templates
â”‚   â””â”€â”€ base.html                # Base template
â”œâ”€â”€ PLSQL/                       # Database triggers and functions
â”‚   â”œâ”€â”€ registration/            # User registration triggers
â”‚   â”œâ”€â”€ employee/                # Employee-related triggers
â”‚   â”‚   â”œâ”€â”€ FunctionForTaxSlab.sql  # Tax calculation
â”‚   â”‚   â”œâ”€â”€ allowanceChangeTrig.sql # Allowance updates
â”‚   â”‚   â””â”€â”€ jobIDChange_Trigger.sql # Job change triggers
â”‚   â””â”€â”€ hr/                      # HR-related triggers
â”‚       â”œâ”€â”€ JobSalaryRangeChangeTrig.sql # Salary updates
â”‚       â””â”€â”€ leaveApprovalTrigger.sql     # Leave approval
â”œâ”€â”€ setup_database.py            # Database initialization script
â”œâ”€â”€ config.env                   # Environment configuration (not in version control)
â”œâ”€â”€ manage.py                    # Django command-line utility
â””â”€â”€ requirements.txt             # Python dependencies
```

## ğŸš€ Installation & Setup

### Prerequisites
- Python 3.8+
- MySQL 8.0+
- pip (Python package manager)

### Installation Steps

1. **Clone the repository**
   ```bash
   git clone https://github.com/yourusername/PayrollManagement.git
   cd PayrollManagement
   ```

2. **Set up a virtual environment**
   ```bash
   python -m venv env
   source env/bin/activate  # On Windows: env\Scripts\activate
   ```

3. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

4. **Create a config.env file with your environment variables**
   Create a file named config.env in the project root with the following contents:
   ```
   # Django Settings
   SECRET_KEY=your-generated-secret-key
   DEBUG=True

   # Database Settings
   DB_ENGINE=django.db.backends.mysql
   DB_NAME=payroll_db
   DB_USER=your_username
   DB_PASSWORD=your_password
   DB_HOST=localhost
   DB_PORT=3306
   ```

   To generate a new SECRET_KEY, run the following command in your Python shell:
   ```python
   from django.core.management.utils import get_random_secret_key
   print(get_random_secret_key())
   ```

5. **Update settings.py to use environment variables**
   Ensure your settings.py uses the python-decouple package to read from config.env:
   ```python
   from decouple import config
   
   SECRET_KEY = config('SECRET_KEY')
   DEBUG = config('DEBUG', default=False, cast=bool)
   
   DATABASES = {
       'default': {
           'ENGINE': config('DB_ENGINE'),
           'NAME': config('DB_NAME'),
           'USER': config('DB_USER'),
           'PASSWORD': config('DB_PASSWORD'),
           'HOST': config('DB_HOST'),
           'PORT': config('DB_PORT'),
       }
   }
   ```

6. **Run database migrations**
   ```bash
   python manage.py makemigrations
   python manage.py migrate
   ```

7. **Initialize database with triggers and initial data**
   ```bash
   python setup_database.py
   ```

8. **Create a superuser**
   ```bash
   python manage.py createsuperuser
   ```

9. **Start the development server**
   ```bash
   python manage.py runserver
   ```

## ğŸ‘¥ User Roles and Access

### Employee
- View personal salary details with complete breakdown
- Clock overtime hours
- Submit and track leave requests
- Monitor attendance records
- View transaction history with payment details

### HR
- Manage employees (add, update, assign roles and departments)
- Update pay scales for job positions
- Process salary disbursements
- Approve or reject leave requests
- Generate various reports (payroll, attendance, leave, tax)
- Access analytics dashboard with financial metrics

## ğŸ—„ï¸ Database Structure

The system employs a relational database with interconnected tables:

### Core Tables
- **Employee**: Personal and professional details
- **Department**: Organizational structure
- **Job & JobSalaryRange**: Positions and compensation

### Financial Tables
- **Payroll**: Core table linking employees to compensation
- **Bonus & Deduction**: Additional payments and withholdings
- **Payment & PaymentDetail**: Transaction records

### Time Management
- **Attendance**: Daily work hours and overtime
- **Leave**: Request status and history

### Technical Implementation
- **Triggers**: Automate calculations and maintain data consistency
- **Functions**: Handle complex logic like tax calculations
- **Foreign Keys**: Enforce data integrity between tables

---
